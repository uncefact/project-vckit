"use strict";(self.webpackChunkvckit_documentation=self.webpackChunkvckit_documentation||[]).push([[2172],{2056:(e,n,t)=>{t.d(n,{Ay:()=>o});var s=t(4848),i=t(8453);function a(e){const n={admonition:"admonition",p:"p",...(0,i.R)(),...e.components};return(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"Please note that this content is under development and is not ready for implementation. This status message will be updated as content development progresses."})})}function o(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},1914:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>d});var s=t(4848),i=t(8453),a=t(2056);const o={sidebar_position:6},r="How to create and manage plugins",c={id:"manage-plugins",title:"How to create and manage plugins",description:"Create a new plugin",source:"@site/docs/manage-plugins.md",sourceDirName:".",slug:"/manage-plugins",permalink:"/project-vckit/docs/next/manage-plugins",draft:!1,unlisted:!1,editUrl:"https://github.com/uncefact/project-vckit/tree/main/docs/manage-plugins.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"getStartedSideBar",previous:{title:"Revocation list 2020",permalink:"/project-vckit/docs/next/vckit-plugins/revocation-list-2020"}},l={},d=[{value:"Create a new plugin",id:"create-a-new-plugin",level:2},{value:"Step 1: Init a new package",id:"step-1-init-a-new-package",level:3},{value:"Step 2: Define the plugin interface",id:"step-2-define-the-plugin-interface",level:3},{value:"Step 3: Implement the plugin",id:"step-3-implement-the-plugin",level:3},{value:"Manage plugin within agent file",id:"manage-plugin-within-agent-file",level:2},{value:"Step 1: Add the plugin to agent.yml",id:"step-1-add-the-plugin-to-agentyml",level:3},{value:"Step 2: Expose the method.",id:"step-2-expose-the-method",level:3}];function p(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"how-to-create-and-manage-plugins",children:"How to create and manage plugins"}),"\n",(0,s.jsx)(a.Ay,{}),"\n",(0,s.jsx)(n.h2,{id:"create-a-new-plugin",children:"Create a new plugin"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-init-a-new-package",children:"Step 1: Init a new package"}),"\n",(0,s.jsxs)(n.p,{children:["First, you need to navigate to ",(0,s.jsx)(n.code,{children:"project-vckit/packages"})," and init a new package.\nIn this guide, we implement a new plugin for hashing a string."]}),"\n",(0,s.jsx)(n.h3,{id:"step-2-define-the-plugin-interface",children:"Step 2: Define the plugin interface"}),"\n",(0,s.jsxs)(n.p,{children:["Navigate to ",(0,s.jsx)(n.code,{children:"packages/core-types/src/types"}),", create a new file and name it ",(0,s.jsx)(n.code,{children:"Itools"})," (this is just an example). This interface extends ",(0,s.jsx)(n.strong,{children:"IPluginMethodMap"})," interface, and has a method ",(0,s.jsx)(n.strong,{children:"computeHash"})," with a string parameter."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { IAgent, IPluginMethodMap } from './IAgent.js';\n\n/**\n * @public\n */\nexport interface IToolsComputeHashArgs {\n  content: string;\n}\n\n/**\n * @public\n */\nexport interface ITools extends IPluginMethodMap {\n  computeHash(\n    args: IToolsComputeHashArgs,\n    context: { agent?: IAgent },\n  ): Promise<string>;\n}\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-3-implement-the-plugin",children:"Step 3: Implement the plugin"}),"\n",(0,s.jsxs)(n.p,{children:["Creating a new plugin means implementing the ",(0,s.jsx)(n.strong,{children:"IAgentPlugin"})," interface."]}),"\n",(0,s.jsx)(n.p,{children:"Example code of the Hash Tool:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { IAgentPlugin, ITools, IToolsComputeHashArgs } from '@uncefact/vckit-core-types';\nimport { sha256 } from 'multiformats/hashes/sha2';\nimport { base58btc } from 'multiformats/bases/base58';\nimport schema from '@uncefact/vckit-core-types/build/plugin.schema.json' assert { type: 'json' };\n\nexport class MultibaseEncodedSHA256 implements IAgentPlugin {\n  readonly methods: ITools;\n  readonly schema = schema.ITools;\n\n  constructor() {\n    this.methods = {\n      computeHash: this.computeHash.bind(this),\n    };\n  }\n\n  async computeHash(args: IToolsComputeHashArgs): Promise<string> {\n    if (\n      typeof args !== 'object' ||\n      !args?.content ||\n      typeof args?.content !== 'string'\n    ) {\n      throw new Error('Value is invalid');\n    }\n\n    const bytes = new TextEncoder().encode(args.content);\n    const hash = await sha256.digest(bytes);\n    const multibasedHash = base58btc.encode(hash.bytes);\n    return multibasedHash;\n  }\n}\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"There're 2 properties of the class are required, both of them are from @uncefact/vckit-core-types:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"methods"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"schema"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"manage-plugin-within-agent-file",children:"Manage plugin within agent file"}),"\n",(0,s.jsx)(n.p,{children:"As you may know, working with VCkit is all about the agent. If you have your custom plugin and want to use it as an extended function then you need to add it to the agent. Here's how to do it."}),"\n",(0,s.jsx)(n.h3,{id:"step-1-add-the-plugin-to-agentyml",children:"Step 1: Add the plugin to agent.yml"}),"\n",(0,s.jsxs)(n.p,{children:["Open the ",(0,s.jsx)(n.code,{children:"agent.yml"})," file, and add this line ",(0,s.jsx)(n.code,{children:"- $require: '@uncefact/vckit-tools#MultibaseEncodedSHA256'"})," at the end of the ",(0,s.jsx)(n.strong,{children:"agent"}),". The updated agent will look like this."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yml",children:"# Agent\nagent:\n  $require: '@veramo/core#Agent'\n  $args:\n    plugins:\n        ...\n        # Add tools plugin for MultibaseEncodedSHA256\n        - $require: '@uncefact/vckit-tools?#MultibaseEncodedSHA256'\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-2-expose-the-method",children:"Step 2: Expose the method."}),"\n",(0,s.jsxs)(n.p,{children:["Under ",(0,s.jsx)(n.strong,{children:"constants"})," > ",(0,s.jsx)(n.strong,{children:"methods"}),", and the new method from the plugin.\nExample: we expose the computeHash method at the end of the ",(0,s.jsx)(n.strong,{children:"methods"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yml",children:"constants:\n  methods:\n    ...\n    # Add method for MultibaseEncodedSHA256\n    - computeHash\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now you can build the project-vckit and start the VCkit api server and test the new plugin."})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var s=t(6540);const i={},a=s.createContext(i);function o(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);